#!/usr/bin/env bash
declare -a globals
declare -a args="$@"

. $(dirname $0)/lib/shared_functions.sh

consistentwork_bootstrap

cwRoot="${globals[0]}"
cwTmpSubmodules="${globals[1]}"
gitDir="${globals[2]}"

#echo  "${cwRoot} ${gitDir}"
pushd ${cwRoot} &>/dev/null

while read -r -a line; do
  path=${line[0]}
  cd "$cwRoot/$path"
  cw_echo $(pwd)
  git add . -A
  git commit "${args}"
done < <(cat ${cwTmpSubmodules})

cd $cwRoot
cw_echo $(pwd)
git add . -A
git commit "${args}"
popd &>/dev/null
